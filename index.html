<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jarvis Heyrose</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background: radial-gradient(circle at top left,#1a1a2e,#0b0b12);
      color:#fff; min-height:100vh;
    }
    .app{display:flex;min-height:100vh}
    .sidebar{
      width:260px; padding:18px;
      background:rgba(255,255,255,.04);
      border-right:1px solid rgba(255,255,255,.08);
      display:flex;flex-direction:column;gap:14px
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      padding:10px;border-radius:14px;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08)
    }
    .logo{
      width:42px;height:42px;border-radius:14px;
      background:linear-gradient(135deg,#7c3aed,#22c55e);
      display:grid;place-items:center;
      font-weight:900;color:#0b0b12
    }
    .brand h1{font-size:14px;font-weight:900}
    .brand p{font-size:12px;opacity:.75;margin-top:2px}

    .menuTitle{font-size:12px;opacity:.65;padding-left:8px;margin-top:6px}
    .menu{display:flex;flex-direction:column;gap:8px}
    .menu button{
      width:100%;text-align:left;
      padding:12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
      color:#fff;cursor:pointer;font-weight:800;
    }
    .menu button.active{
      background:rgba(124,58,237,.25);
      border-color:rgba(124,58,237,.45)
    }

    .main{flex:1;padding:24px;display:flex;flex-direction:column;gap:16px}
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
    .status{
      display:inline-flex;align-items:center;gap:8px;
      padding:10px 14px;border-radius:999px;
      background:rgba(34,197,94,.12);
      border:1px solid rgba(34,197,94,.25);
      font-weight:900;font-size:13px
    }
    .dot{width:10px;height:10px;border-radius:50%;background:#22c55e;box-shadow:0 0 12px rgba(34,197,94,.8)}

    .right{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .timer{
      padding:10px 14px;border-radius:999px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      font-weight:900;font-size:13px
    }

    /* AUTH */
    .authArea{position:relative;display:flex;align-items:center;gap:10px}
    .btn{
      border:none;cursor:pointer;
      padding:10px 14px;border-radius:14px;
      color:#fff;font-weight:900;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      display:inline-flex;align-items:center;gap:10px;
      user-select:none;
    }
    .btn:hover{background:rgba(255,255,255,.10)}
    .googleIcon{
      width:18px;height:18px;border-radius:6px;
      background:conic-gradient(from 180deg,#ea4335 0 25%,#fbbc05 0 50%,#34a853 0 75%,#4285f4 0 100%);
      box-shadow:0 0 0 1px rgba(255,255,255,.12) inset;
    }
    .btnPurple{
      background:rgba(124,58,237,.22);
      border:1px solid rgba(124,58,237,.35);
    }
    .btnPurple:hover{background:rgba(124,58,237,.30)}

    /* DROPDOWN */
    .dropdown{
      position:absolute;top:48px;right:0;
      width:240px;
      background:rgba(15,15,25,.96);
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      box-shadow:0 18px 40px rgba(0,0,0,.55);
      padding:10px;
      display:none;
      z-index:999;
      backdrop-filter: blur(10px);
    }
    .dropdown .email{
      font-size:12px;opacity:.9;
      padding:10px 10px 8px;
      border-bottom:1px solid rgba(255,255,255,.10);
      margin-bottom:8px;
      word-break:break-all;
    }
    .dropdown .dropBtn{
      width:100%;
      text-align:left;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:#fff;cursor:pointer;font-weight:900;
    }
    .dropdown .dropBtn:hover{background:rgba(255,255,255,.10)}

    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
    .card{
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      border-radius:20px;
      padding:16px;min-height:120px;
      cursor:pointer;transition:.2s;
      display:flex;flex-direction:column;gap:10px
    }
    .card:hover{transform:translateY(-2px);background:rgba(255,255,255,.06)}
    .cardTitle{font-weight:900;font-size:16px}
    .cardDesc{font-size:13px;opacity:.75;line-height:1.35}
    .badge{
      font-size:12px;font-weight:900;
      padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      display:inline-block;align-self:flex-start;
    }

    .panel{
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      border-radius:20px;padding:18px;
      display:flex;flex-direction:column;gap:12px
    }
    .panel h2{font-size:18px;font-weight:900}
    .warn{
      padding:12px 14px;border-radius:14px;
      background:rgba(245,158,11,.12);
      border:1px solid rgba(245,158,11,.25);
      font-size:13px;font-weight:800;line-height:1.35;
      display:none;
    }
    .row{display:flex;gap:10px;flex-wrap:wrap}
    textarea{
      flex:1;min-width:260px;min-height:90px;
      padding:14px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.25);
      color:#fff;outline:none;font-size:14px
    }
    .action{
      padding:14px 18px;border-radius:14px;
      border:none;cursor:pointer;font-weight:900;
      background:linear-gradient(135deg,#7c3aed,#22c55e);
      color:#0b0b12;min-width:180px;
    }
    .action:hover{transform:translateY(-1px)}

    .results{display:none;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px}
    .box{
      background:rgba(0,0,0,.25);
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;padding:12px;min-height:140px
    }
    .box h3{font-size:13px;font-weight:900;opacity:.9;margin-bottom:8px}
    .item{font-size:13px;opacity:.85;margin-bottom:6px;line-height:1.35}
    .copy{
      margin-top:10px;width:100%;
      padding:10px;border-radius:12px;
      border:none;cursor:pointer;font-weight:900;
      background:rgba(255,255,255,.08);color:#fff
    }
    .copy:hover{background:rgba(255,255,255,.12)}

    .links{text-align:center;font-size:13px;opacity:.8}
    .links a{color:#22c55e;text-decoration:none;font-weight:900;margin:0 10px}

    @media(max-width:980px){
      .grid{grid-template-columns:repeat(2,minmax(0,1fr))}
      .results{grid-template-columns:1fr}
      .sidebar{width:220px}
    }
    @media(max-width:720px){
      .app{flex-direction:column}
      .sidebar{width:100%}
      .grid{grid-template-columns:1fr}
      .dropdown{right:auto;left:0}
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">JH</div>
        <div>
          <h1>JARVIS HEYROSE</h1>
          <p>AI • Ders • Video</p>
        </div>
      </div>

      <div class="menuTitle">Odalar</div>
      <div class="menu" id="menu"></div>

      <div style="margin-top:auto;font-size:12px;opacity:.7;padding:10px;border-radius:14px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08)">
        Limitler: 3 başlık / 3 hashtag / 3 açıklama • Süre: 30 dk
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="status"><span class="dot"></span> Sistem Aktif</div>

        <div class="right">
          <div class="timer">⏳ <span id="timeLeftText">30:00</span></div>

          <div class="authArea" id="authArea">
            <button class="btn" id="googleBtn" type="button">
              <span class="googleIcon"></span> Google ile Giriş
            </button>

            <!-- GİRİŞTEN SONRA GÖRÜNECEK -->
            <button class="btn btnPurple" id="userMenuBtn" type="button" style="display:none;">Menü</button>

            <div class="dropdown" id="userDropdown">
              <div class="email" id="userEmail">-</div>
              <button class="dropBtn" id="logoutBtn" type="button">Çıkış Yap</button>
            </div>
          </div>
        </div>
      </div>

      <section class="grid" id="roomsGrid"></section>

      <section class="panel">
        <h2 id="panelTitle">Bir oda seç</h2>

        <div class="warn" id="warnBox">
          ⚠️ Bu içerikler yapay zekâ tarafından üretilir. Doğruluğu %100 garanti değildir.
        </div>

        <div class="row">
          <textarea id="userInput" placeholder="Ne istiyorsun? Örnek: 'YouTube shorts için viral başlık ve hashtag'"></textarea>
          <button class="action" id="generateBtn" type="button">Üret</button>
        </div>

        <div class="results" id="results">
          <div class="box">
            <h3>3 Başlık</h3>
            <div id="titles"></div>
            <button class="copy" type="button" onclick="copyBox('titles')">Kopyala</button>
          </div>
          <div class="box">
            <h3>3 Hashtag</h3>
            <div id="hashtags"></div>
            <button class="copy" type="button" onclick="copyBox('hashtags')">Kopyala</button>
          </div>
          <div class="box">
            <h3>3 Açıklama</h3>
            <div id="descs"></div>
            <button class="copy" type="button" onclick="copyBox('descs')">Kopyala</button>
          </div>
        </div>

        <div class="links">
          <a href="privacy.html" target="_blank">Gizlilik Politikası</a> |
          <a href="terms.html" target="_blank">Hizmet Şartları</a>
        </div>
      </section>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // SUPABASE
    const SUPABASE_URL = "https://cdzxzgwvebmvccfkvfll.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_QDz16Zn2HeoOw7Sf25PENA_FgZL0P-F";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const googleBtn = document.getElementById("googleBtn");
    const userMenuBtn = document.getElementById("userMenuBtn");
    const userDropdown = document.getElementById("userDropdown");
    const userEmailEl = document.getElementById("userEmail");
    const logoutBtn = document.getElementById("logoutBtn");
    const authArea = document.getElementById("authArea");

    function setLoggedOutUI(){
      googleBtn.style.display = "inline-flex";
      userMenuBtn.style.display = "none";
      userDropdown.style.display = "none";
      userEmailEl.textContent = "-";
    }
    function setLoggedInUI(email){
      googleBtn.style.display = "none";
      userMenuBtn.style.display = "inline-flex";
      userEmailEl.textContent = email || "-";
      userDropdown.style.display = "none";
    }

    googleBtn.addEventListener("click", async () => {
      const redirectTo = window.location.origin; // https://www.jarvisheyrose.com
      const { error } = await supabase.auth.signInWithOAuth({
        provider: "google",
        options: { redirectTo }
      });
      if (error) alert("Giriş hatası: " + error.message);
    });

    userMenuBtn.addEventListener("click", () => {
      userDropdown.style.display = (userDropdown.style.display === "block") ? "none" : "block";
    });

    document.addEventListener("click", (e) => {
      if (!authArea.contains(e.target)) userDropdown.style.display = "none";
    });

    logoutBtn.addEventListener("click", async () => {
      userDropdown.style.display = "none";
      const { error } = await supabase.auth.signOut();
      if (error) alert("Çıkış hatası: " + error.message);
      window.location.href = window.location.origin;
    });

    (async () => {
      const { data } = await supabase.auth.getSession();
      const email = data?.session?.user?.email;
      if (email) setLoggedInUI(email);
      else setLoggedOutUI();
    })();

    supabase.auth.onAuthStateChange((_event, session) => {
      const email = session?.user?.email;
      if (email) setLoggedInUI(email);
      else setLoggedOutUI();
    });

    // 30 DK TIMER
    const TOTAL_SECONDS = 30 * 60;
    let secondsLeft = TOTAL_SECONDS;
    function fmt(s){
      const m = String(Math.floor(s/60)).padStart(2,'0');
      const ss = String(s%60).padStart(2,'0');
      return `${m}:${ss}`;
    }
    document.getElementById("timeLeftText").textContent = fmt(secondsLeft);
    setInterval(()=> {
      secondsLeft--;
      if(secondsLeft < 0) secondsLeft = 0;
      document.getElementById("timeLeftText").textContent = fmt(secondsLeft);
      if(secondsLeft === 0){
        alert("Bugün size ayrılan sürenin sonuna geldik. Yarın tekrar görüşürüz.");
      }
    }, 1000);

    // ROOMS
    const rooms = [
      { id:"youtube", name:"YouTube Odası", desc:"Başlık / Hashtag / Açıklama", badge:"Free" },
      { id:"insta", name:"Instagram Reels Odası", desc:"Başlık / Hashtag / Açıklama", badge:"Free" },
      { id:"tiktok", name:"TikTok Odası", desc:"Başlık / Hashtag / Açıklama", badge:"Free" },
      { id:"facebook", name:"Facebook Odası", desc:"Başlık / Hashtag / Açıklama", badge:"Free" },
      { id:"x", name:"X (Twitter) Odası", desc:"Başlık / Hashtag / Açıklama", badge:"Free" },
      { id:"ders", name:"Ders 30dk (İlk/Orta/Lise)", desc:"30 dk çalışma", badge:"30dk" },
      { id:"uni", name:"Üniversite Adayları", desc:"30 dk çalışma", badge:"30dk" },
      { id:"kpss", name:"KPSS Test Odası", desc:"30 dk test", badge:"30dk" },
      { id:"analiz", name:"Kanal Analiz Odası", desc:"Kanal büyütme", badge:"Free" }
    ];
    let currentRoom = null;

    const menu = document.getElementById("menu");
    const grid = document.getElementById("roomsGrid");
    const panelTitle = document.getElementById("panelTitle");
    const warnBox = document.getElementById("warnBox");

    function renderMenu(){
      menu.innerHTML = "";
      rooms.forEach(r=>{
        const b = document.createElement("button");
        b.textContent = r.name;
        b.id = "m_"+r.id;
        b.onclick = ()=>selectRoom(r.id);
        menu.appendChild(b);
      });
    }
    function renderGrid(){
      grid.innerHTML = "";
      rooms.forEach(r=>{
        const c = document.createElement("div");
        c.className = "card";
        c.onclick = ()=>selectRoom(r.id);
        c.innerHTML = `
          <div class="cardTitle">${r.name}</div>
          <div class="badge">${r.badge}</div>
          <div class="cardDesc">${r.desc}</div>
        `;
        grid.appendChild(c);
      });
    }
    function selectRoom(id){
      currentRoom = rooms.find(x=>x.id===id);
      rooms.forEach(r=>{
        const b = document.getElementById("m_"+r.id);
        if(b) b.classList.toggle("active", r.id===id);
      });
      panelTitle.textContent = currentRoom.name + " • Üretim";
      document.getElementById("results").style.display = "none";

      if(["ders","uni","kpss"].includes(id)) warnBox.style.display = "block";
      else warnBox.style.display = "none";
    }

    renderMenu();
    renderGrid();

    // GENERATE (dummy)
    function renderList(id, arr){
      const el = document.getElementById(id);
      el.innerHTML = "";
      arr.forEach((t,i)=>{
        const d = document.createElement("div");
        d.className = "item";
        d.textContent = (i+1)+") "+t;
        el.appendChild(d);
      });
    }
    function platformName(id){
      return ({
        youtube:"YouTube", insta:"Instagram Reels", tiktok:"TikTok",
        facebook:"Facebook", x:"X", ders:"Ders", uni:"Üniversite", kpss:"KPSS", analiz:"Analiz"
      })[id] || "Platform";
    }

    document.getElementById("generateBtn").addEventListener("click", ()=>{
      if(!currentRoom) return alert("Önce oda seç.");
      const txt = document.getElementById("userInput").value.trim();
      if(!txt) return alert("Bir şey yaz.");

      const p = platformName(currentRoom.id);

      const titles = [
        `${txt} | ${p} için güçlü başlık`,
        `${p} ${txt} (yüksek arama)`,
        `${txt} — Bugün dene`
      ];
      const tags = [`#${p.replace(/\W/g,'')||'Kesfet'}`, "#Kesfet", "#Trend"];
      const descs = [
        `${p} için: ${txt}\nKaydet + paylaş.`,
        `${txt} burada.\nTakip etmeyi unutma.`,
        `Bugün dene: ${txt}\nYorum bırak.`
      ];

      renderList("titles", titles);
      renderList("hashtags", tags);
      renderList("descs", descs);

      document.getElementById("results").style.display = "grid";
    });

    function copyBox(id){
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(()=>alert("Kopyalandı"))
      .catch(()=>alert("Manuel kopyala."));
    }
  </script>
</body>
</html>
